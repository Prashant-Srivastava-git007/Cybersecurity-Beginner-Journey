# üõ°Ô∏è Windows Registry Analysis ‚Äì Beginner Guide

The Windows Registry is one of the most valuable sources of forensic evidence in Windows systems. It stores configuration settings, OS information, user activity, installed applications, and traces of malware behavior.

---

## üîç What Is the Windows Registry?

The Windows Registry acts as a central database that stores:

* Operating system settings
* Hardware configuration
* User preferences
* Installed software details
* Application behavior
* Evidence of user activity
* Malware persistence mechanisms

For investigators, the Registry helps reconstruct what happened, who did it, and when it occurred.

---

## üóÇÔ∏è Registry Structure

The Registry is organized like a file system:

* Hives: Large database files
* Keys: Folder-like structures
* Values: Individual settings/data

### üèõÔ∏è Major Registry Hives

| Hive                           | Description                               |
| ------------------------------ | ----------------------------------------- |
| **HKLM ‚Äì HKEY_LOCAL_MACHINE**  | System-wide hardware & software settings  |
| **HKCU ‚Äì HKEY_CURRENT_USER**   | Settings for the currently logged-in user |
| **HKCR ‚Äì HKEY_CLASSES_ROOT**   | File associations and COM object info     |
| **HKU ‚Äì HKEY_USERS**           | All user profiles loaded on the system    |
| **HKCC ‚Äì HKEY_CURRENT_CONFIG** | Current hardware profile settings         |

### üìÅ Registry Hive Files

| Registry Hive Path | Backing Files                                                          |
| ------------------ | ---------------------------------------------------------------------- |
| HKLM\SAM           | Sam, Sam.log, Sam.sav                                                  |
| HKLM\Security      | Security, Security.log, Security.sav                                   |
| HKLM\Software      | Software, Software.log, Software.sav                                   |
| HKLM\System        | System, System.alt, System.log, System.sav                             |
| HKCC               | System, System.alt, System.log, System.sav, Ntuser.dat, Ntuser.dat.log |
| HKU\DEFAULT        | Default, Default.log, Default.sav                                      |

---

## üß© Detailed Description of Predefined Registry Keys

### HKEY_CURRENT_USER (HKCU)

Contains settings for the currently logged-in user, such as:

* Desktop preferences
* Control Panel settings
* User-specific configurations

### HKEY_LOCAL_MACHINE (HKLM)

Stores system-level configuration for all users:

* Drivers
* Services
* Installed software

### HKEY_CLASSES_ROOT (HKCR)

Controls file-type associations.
It is a merged view of:

* HKLM\Software\Classes ‚Üí system-wide defaults
* HKCU\Software\Classes ‚Üí user-specific overrides


### HKEY_CURRENT_CONFIG (HKCC)

Stores hardware profile data used during system startup.

---

## üõ†Ô∏è Tools for Registry Analysis

Below are two widely used tools to parse and analyze registry hives.

### 1Ô∏è‚É£ Registry Explorer

Registry Explorer is a GUI tool that allows investigators to load and analyze offline Registry hives.

**Key Features**

* View multiple hives at once
* Search across all loaded hives
* Export data
* Supports regex searching

**Useful Evidence Found**

* Malware persistence keys
* Recently accessed files
* Mounted drives
* Installed/uninstalled programs
* Services information
* User activity (NTUSER.DAT, UsrClass.dat)
* Evidence of program execution

**Common Hive Locations**

(Example paths ‚Äî actual paths vary by system)
```
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SECURITY
C:\Windows\System32\config\SOFTWARE
C:\Windows\System32\config\SYSTEM
C:\Users\<UserName>\NTUser.dat
C:\Users\<UserName>\AppData\Local\Microsoft\Windows\UsrClass.dat
```

### 2Ô∏è‚É£ RegRipper

RegRipper is a command-line and GUI tool for extracting registry artifacts automatically using plugins.

It generates .txt reports summarizing registry evidence.

**‚ñ∂Ô∏è Running RegRipper (Command Line)**

Place all hive files in a directory, then run:

```cmd
for /r %i in (*) do (path\to\rip.exe -r %i -a > %i.txt)
```

**Explanation**

* `for /r %i in (*) do` ‚Üí loops through all files in the folder and subfolders
* `rip.exe -r %i` ‚Üí processes each file as a hive
* `-a` ‚Üí runs all available plugins
* `> %i.txt` ‚Üí saves the output report

This creates one text report per hive automatically.

### üñ•Ô∏è RegRipper GUI

RegRipper also comes with a simple GUI where you can:

* Select a hive file
* Choose plugins or run all
* Generate .txt reports

The GUI is included in the GitHub release package.

---
