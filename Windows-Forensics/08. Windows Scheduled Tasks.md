# ğŸ•’ Windows Scheduled Tasks 

Scheduled Tasks are an important artifact in Windows forensic investigations. They help analysts understand what ran, when it ran, and who triggered itâ€”useful for both detecting malware persistence and reconstructing system activity.

---

## ğŸ” What Are Scheduled Tasks?

Scheduled Tasks allow Windows to automatically run programs or scripts at specific times or events.

They are used for:
* System maintenance (updates, cleanup, backups)
* User automation
* Malicious persistence (attackers frequently abuse scheduled tasks)

Because tasks log when they were created, modified, and last executed, they play a key role in timeline reconstruction during an investigation.

---

## ğŸ§ª Why Are Scheduled Tasks Important in Forensics?

**Scheduled Tasks help investigators identify:**
* Persistence mechanisms used by malware
* Scripts or binaries executed automatically
* Suspicious activity tied to specific users
* Changes to task configuration over time

**Attackers often use Scheduled Tasks for:**
* Running malicious payloads at boot
* Triggering scripts on a schedule
* Re-establishing persistence after reboot
* Automating data collection or exfiltration

---

## ğŸ“‚ Location of Scheduled Task Artifacts

### 1. File System Location

All Scheduled Task definitions are stored as XML files:

`
C:\Windows\System32\Tasks
`
Each XML file may contain:
* Task name
* Triggers (when the task runs)
* Actions (what the task executes)
* Execution times
* User account used to run the task

### 2. Registry Locations

Scheduled Task metadata is also stored in the Windows Registry:

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree
```
The TaskCache keys help identify:
* Task GUIDs
* Task paths
* Last run times
* Associated actions


**NOTE :-**
* `TaskCache\Tasks â†’` Stores GUID-based metadata for each task, including last run time, next run time, security info, and configuration details..
* `TaskCache\Tree â†’` Stores human-readable task names and folder structure, mapping each name to its GUID for identification..
  
---

## ğŸ“ Extracting Task Information During Forensics

### âœ” From RegRipper Output

The taskcache plugin in RegRipper extracts Scheduled Task info directly from the registry.

Look for entries showing:
* Task names
* File paths
* Run times
* Suspicious command lines

### âœ” From KAPE Collection

KAPE collects the same Scheduled Task files under:

```
C:\Windows\System32\Tasks

```

This allows us to review tasks even when parsing a forensic image.
