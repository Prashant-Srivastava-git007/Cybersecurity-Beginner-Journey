# Prefetch Analysis 

---

## üîç What Are Prefetch Files?

Prefetch files are created by Windows to speed up application startup. They store information about programs that were recently executed on the system.
* Introduced in Windows XP
* Still present in modern versions (Windows 7, 8, 10, 11)
* Used primarily for performance optimization
* Extremely useful in forensic investigations

---

## üß™ Why Prefetch Files Matter in Forensics

**Prefetch files can reveal:**
* Which applications were executed
* Execution timestamps
* Full file paths
* Number of times the application was run
* Information about associated files loaded during execution

**This makes them useful for:**
* Malware execution tracing
* Verifying user activity
* Establishing a timeline
* Detecting persistence or suspicious program launches

---

## üìÇ Location of Prefetch Files

Prefetch files are stored in: `C:\Windows\Prefetch`

They have a .pf extension.

> ‚úÖ Note: Windows creates one Prefetch file per unique combination of
> {Application Name + Path + Command-Line Arguments}

---

## üìÅ Prefetch File Structure (Overview)

**Each .pf file contains:**
* A header (format version, metadata)
* Executable file path
* Last execution timestamps
* Execution count
* Volume information (device, serial number)
* Referenced file list

Understanding these elements helps build a reliable activity timeline.

---

## ‚öôÔ∏è Tools for Prefetch Analysis

### PECmd (Eric Zimmerman's Tool)

PECmd is one of the most reliable tools for parsing Prefetch files.

‚úî Parses all known Prefetch versions

‚úî Can process compressed Prefetch files (Win8+)

‚úî Supports entire directory parsing

‚úî Generates CSV output and timelines

Many other Prefetch parsers cannot handle compressed files or multiple files at once‚ÄîPECmd solves this problem.

### ‚ñ∂Ô∏è Using PECmd to Parse Prefetch Files

Here is the typical command:

```cmd
PECmd.exe -d C:\Windows\Path\To\Prefetch --csv C:\Path\To\Save\Output --csvf Prefetch.csv
```

**Breakdown of the Command:**

| Component                    | Explanation                             |
| ---------------------------- | --------------------------------------- |
| **PECmd.exe**                | The main Prefetch parsing executable    |
| **-d <directory>**           | Directory containing the Prefetch files |
| **--csv <output_directory>** | Where to save parsed CSV results        |
| **--csvf <filename>**        | Sets the CSV output filename            |

---

**‚ö†Ô∏è Important Note**

> Prefetch must be enabled on the system for the files to exist.
> Some systems (especially Windows Server versions) may have Prefetch disabled.

---
