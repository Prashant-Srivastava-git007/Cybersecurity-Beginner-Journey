# ðŸ—ï¸ Windows Run Keys

Run Keys are important Windows Registry locations that control which programs start automatically when the system boots or when a user logs in. They are used by legitimate applications for convenienceâ€”but also heavily abused by attackers for persistence.

Understanding and analyzing Run Keys helps identify unauthorized startup programs and detect suspicious activity on a compromised system.

---

## ðŸ” What Are Run Keys?

Run Keys store entries that contain:
* Application Name
* Command or executable path
* Optional execution parameters

When Windows starts or when a user logs in, entries in these keys are executed automatically.

---

## ðŸ“Œ Common Run Key Locations

### User-specific Run Keys

Used for programs that run only for the currently logged-in user:

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce
```

### System-wide Run Keys

Used for programs that run for all users:

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run

HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce
```

**NOTE:**
* **RUN Keys â†’** Programs listed here run every time the system starts or the user logs in.
* **RUNONCE Keys â†’** Programs listed here run only once, then Windows automatically deletes the entry after execution.

---

## ðŸ›¡ï¸ Why Run Keys Matter in Forensics

**Run Keys often reveal:**
* Persistence mechanisms used by malware
* Startup applications (legitimate or suspicious)
* Evidence of tampering or removed entries
* Unexpected or hidden executable paths
* Indicators of unauthorized access

**Attackers may:**
* Add malicious entries
* Modify existing values
* Delete logs or startup entries
* Use registry redirection to hide their presence

This makes Run Key analysis a critical step in any investigation.

---

## ðŸ”§ Tool Used for Analysis

**Registry Explorer**
A powerful GUI tool for inspecting offline Registry hives and examining Run Keys safely.

---

# ðŸ” Windows Services

Windows Services are long-running system processes that operate in the background. They support essential OS functions such as networking, security, device management, and application services.

For forensic investigators and cybersecurity analysts, Windows Services are important because attackers often abuse them to:
* Maintain persistence
* Execute malicious payloads
* Hide unauthorized activities
* Run code with elevated privileges

Understanding how services work â€” and how to analyze them â€” is a key skill in Windows forensics.

---

## ðŸ§  What Are Windows Services?

**Windows Services are:**
* Background processes that do not require user interaction
* Able to start automatically when the system boots
* Managed by the Service Control Manager (SCM)
* Capable of running with SYSTEM or elevated privileges

These characteristics make them both powerful and potentially dangerous when misused.

---

## âš ï¸ Why Attackers Abuse Windows Services

Threat actors commonly modify or create services to:
* Auto-start malware after reboot
* Run payloads silently in the background
* Masquerade as legitimate services
* Gain persistence through service misconfiguration

---

## ðŸ“ Where Windows Stores Service Information

All Windows Services are stored in a central Registry location:

`
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services
`

Inside this key, each subkey represents one service.

**Common fields found in a service entry:**

| Registry Field  | Description                          |
| --------------- | ------------------------------------ |
| **ImagePath**   | Executable path of the service       |
| **DisplayName** | User-friendly name                   |
| **Start**       | Startup type (0â€“4 values)            |
| **Type**        | Service type (driver, service, etc.) |
| **ServiceDLL**  | DLL used by service (if applicable)  |
| **ObjectName**  | Account used to run the service      |


**Service Start Types**

| Value | Meaning      |
| ----- | ------------ |
| **0** | Boot Start   |
| **1** | System Start |
| **2** | Automatic    |
| **3** | Manual       |
| **4** | Disabled     |

> Useful for identifying suspicious auto-starting malicious services.

---

**Checking Services with RegRipper**

When analyzing registry dumps, we can search RegRipper output for: `svc v.`

This helps locate:
* All installed services
* Their configuration
* Associated timestamps

Timestamps may reveal when a service was created or modified, useful for timeline correlation during incident investigations.

---
