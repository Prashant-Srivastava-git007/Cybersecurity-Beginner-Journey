# üîç Background Activity Monitor (BAM) 

The Background Activity Monitor (BAM) is a helpful Windows artifact that tracks recently executed applications. Even when other traces are missing, BAM can reveal what programs were run by users on the system.

Introduced in Windows 10 (version 1803), BAM‚Äôs original purpose is to improve performance and battery life by managing background apps. For forensic analysts, however, it provides valuable insight into recent user activity.

---

## üìÇ What BAM Records

BAM stores details about applications that have been executed, including:
* Full executable path
* Last execution timestamp
* User-specific entries (based on SID)

This makes BAM especially useful for correlating program execution during investigations.

---

## üîë Registry Location

BAM data is stored in the Windows Registry at:

`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\<User SID>`

Each entry represents:
* An executable path
* A timestamp showing when the application last ran

---

## üë§ User-Specific Data

BAM keeps records for each user on the system.
The subkeys are named using Security Identifiers (SIDs), allowing analysts to match activity to specific user accounts.

---

## ‚ö†Ô∏è Limitations of BAM

While BAM is powerful, it has several limitations:
* Short retention period ‚Äî old entries may be overwritten as new applications run.
* Not all executions are logged ‚Äî very quick executions may not appear.
* Focuses on user-interactive executables ‚Äî some background processes may be missed.
* Not a long-term history ‚Äî best for identifying recent activity.

---

# üß© Application Compatibility Cache (Shimcache) 

The Application Compatibility Cache, commonly known as Shimcache, is an important Windows forensic artifact. It helps investigators identify potential program execution, even when other logs are missing or have been tampered with. 

---

## üîç What Is Shimcache?

Shimcache is a Windows feature originally designed to ensure older applications remain compatible with newer Windows versions.
While its purpose is not security-related, it unintentionally records useful forensic information whenever Windows detects or interacts with an executable file.

Shimcache can reveal:
* File paths of executables
* Last modified timestamps
* Whether Windows recognized the file
* A partial timeline of program activity

---

## üïµÔ∏è Why Is Shimcache Important in Forensics?

Even if logs are deleted or a system is cleaned, Shimcache may still store traces of activity. 

It helps investigators:
* Reconstruct a timeline of program activity
* Identify suspicious executables
* Validate or refute user claims
* Support incident response and malware analysis

> ‚ö†Ô∏è Note: Shimcache does not guarantee a program was actually executed‚Äîonly that Windows became aware of it.

---

## üìç Shimcache Registry Locations

Shimcache data is stored in the Windows Registry:

**Windows XP ‚Äì Windows 7**

`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache`

**Windows 8 and Later**

`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache\AppCompatCache`

---

## ‚ö†Ô∏è Important Limitations

* Not definitive proof of execution: Some entries appear simply because a file existed on the system.
* Limited size: Older entries can be overwritten by new ones.
* Written only at shutdown: If a system never shuts down, recent activity may not be saved.

> Because of these limitations, investigators should collect Shimcache data as early as possible.

---

## üõ†Ô∏è Tools for Processing Shimcache

A common tool for parsing Shimcache is:

**AppCompatCacheParser / AppCompatParse**

Example usage:

`AppCompatCacheParser.exe -f C:\Users\Elliot\Desktop\Case_Files\Clean_Registry_Hives\SYSTEM_clean --csv C:\Users\Elliot\Desktop\Case_Files\Execution`


This command extracts Shimcache entries from a SYSTEM hive and saves the result as a CSV file.

After exporting the CSV, you can open it in tools like:
* Timeline Explorer
* Excel
* Any CSV viewer

These tools make it easier to visualize and analyze the program activity timeline.

---
