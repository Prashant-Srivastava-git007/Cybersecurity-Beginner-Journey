# UltraVNC Initial Access Analysis (Sysmon Log Lab)

---

## Overview

This lab is inspired by **Palo Alto Unit 42 research** on an **UltraVNC malware campaign**, where attackers used a **backdoored UltraVNC binary** to maintain persistent access.

we will review Sysmon events to identify:

* Malicious process activity
* File creation and modification
* Network communication
* Process termination behavior

---

## Log File

* **Log File:** *Download from Asset*

---

## Sysmon Event IDs Reference

Use the following Sysmon Event IDs while answering the questions:

### Process & Execution

* **Event ID 1** – Process Creation
* **Event ID 5** – Process Terminated
* **Event ID 8** – CreateRemoteThread
* **Event ID 10** – Process Access
* **Event ID 25** – Process Tampering

### File System Activity

* **Event ID 2** – File Creation Time Changed
* **Event ID 11** – File Created
* **Event ID 15** – File Create Stream Hash
* **Event ID 23** – File Deleted (Archived)
* **Event ID 26** – File Deleted (Logged)
* **Event ID 29** – Executable File Created

### Network Activity

* **Event ID 3** – Network Connection
* **Event ID 22** – DNS Query

### Registry & Persistence

* **Event ID 12** – Registry Create/Delete
* **Event ID 13** – Registry Value Set
* **Event ID 14** – Registry Rename

### Advanced & System Events

* **Event ID 4** – Sysmon Service State Change
* **Event ID 6** – Driver Loaded
* **Event ID 7** – Image Loaded
* **Event ID 17** – Named Pipe Created
* **Event ID 18** – Named Pipe Connected
* **Event ID 19–21** – WMI Persistence Events
* **Event ID 16** – Sysmon Configuration Change

---

## Investigation Questions

Answer the following based on your analysis of the Sysmon logs:

1. How many files were created during the attack?
2. What was the **malicious process** that infected the victim system?
3. Which **cloud drive service** was used to distribute the malware?
4. What timestamp was set for a **PDF file** whose creation time was modified?
5. Where was **`once.cmd`** created on disk?
   *(Provide full file path including filename.)*
6. Which **dummy domain** did the malware attempt to contact to verify internet connectivity?
7. Which **IP address** did the malicious process try to reach?
8. When did the malicious process **terminate itself** after deploying the backdoored UltraVNC?

---


