# SPL (Search Processing Language) 

---

## What is SPL?
**Search Processing Language (SPL)** is Splunkâ€™s query language used to search, filter, and analyze indexed data.  
With SPL, you can:
- Search through logs
- Filter relevant events
- Perform calculations
- Create reports and visualizations

SPL works as a **pipeline**, where each command passes results to the next command using `|`.

---

## Search Field Operators

Field operators help filter and refine search results.

### 1. Comparison Operators
Used to compare field values.

| Operator | Example | Meaning |
|--------|--------|--------|
| `=` | `UserName=Mark` | Match events where `UserName` is Mark |
| `!=` | `UserName!=Mark` | Exclude events where `UserName` is Mark |
| `<` | `Age < 10` | Values less than 10 |
| `<=` | `Age <= 10` | Values less than or equal to 10 |
| `>` | `Outbound_Traffic > 50` | Values greater than 50 |
| `>=` | `Outbound_Traffic >= 50` | Values greater than or equal to 50 |

---

### 2. Boolean Operators
Used to combine conditions.

| Operator | Example | Meaning |
|--------|--------|--------|
| `AND` | `fieldA=value1 AND fieldB=value2` | Both conditions must match |
| `OR` | `fieldA=value1 OR fieldA=value2` | Either value can match |
| `NOT` | `fieldA NOT value` | Excludes matching events |

---

### 3. Wildcards
Used to match partial text.

| Symbol | Example | Meaning |
|------|--------|--------|
| `*` | `status=fail*` | Matches `failed`, `failure`, etc. |

---

## Filtering Results in SPL

Large environments generate thousands of logs. Filters help focus on relevant data.

### `search`
Used to filter events based on keywords or fields.

**Syntax**
```spl
| search <keyword>
````

**Example**

```spl
| search Preventivo*
```

---

### `dedup`

Removes duplicate values from results.

**Syntax**

```spl
| dedup <field_name>
```

**Example**

```spl
| dedup ProcessID
```

---

## Structuring Search Results

### `table`

Displays selected fields as columns.

**Syntax**

```spl
| table field1 field2
```

---

### `head`

Returns the first results.

**Syntax**

```spl
| head <number>
```

**Examples**

```spl
| head
| head 20
```

---

### `tail`

Returns the last results.

**Syntax**

```spl
| tail <number>
```

**Examples**

```spl
| tail
| tail 20
```

---

### `sort`

Orders results.

**Syntax**

```spl
| sort <field_name>
```

**Example**

```spl
| sort TargetFilename
```

---

### `reverse`

Reverses the order of events.

**Syntax**

```spl
| reverse
```

---

## Transformational Commands

### `top`

Shows most frequent values.

**Syntax**

```spl
| top <field_name>
| top limit=5 <field_name>
```

**Example**

```spl
| top limit=3 TargetFilename
```

---

### `rare`

Shows least frequent values.

**Syntax**

```spl
| rare <field_name>
| rare limit=5 <field_name>
```

**Example**

```spl
| rare limit=3 TargetFilename
```

---

### `stats`

Performs statistical calculations.

**Syntax**

```spl
| stats <function>(field)
| stats <function>(field) by field
```

**Example**

```spl
| stats count by TargetFilename
```

---

### `chart`

Creates tabular or visual summaries.

**Syntax**

```spl
| chart <function>
```

**Example**

```spl
| chart count by Image
```

---

### `timechart`

Creates time-based visualizations.

**Syntax**

```spl
| timechart <function> by <field>
```

**Example**

```spl
| timechart count by host
```

---
