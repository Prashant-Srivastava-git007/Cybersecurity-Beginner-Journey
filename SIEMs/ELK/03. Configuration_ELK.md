# Configure Elastic SIEM with Windows Agent

---

## Objective

* Configure Elastic as a SIEM
* Enable **Elastic Defend (EDR)**
* Enroll a Windows system to collect logs and security telemetry

---

## Prerequisites

* Elastic Stack running on Kali Purple
* Access to the Elastic web interface
* One Windows system (VM or physical)
* Internet connectivity between Elastic and Windows host

---

## Step 1: Access Elastic Dashboard

1. Open a browser and navigate to:

   ```
   https://<SIEM-IP>:5601
   ```
2. Log in using:

   * **Username:** `elastic`
   * **Password:** the one set during installation

This opens the **Kibana dashboard**, which is used to manage Elastic.

---

## Step 2: Add Elastic Defend Integration

1. Go to **Integrations** from the left menu.
2. Search for and select **Elastic Defend**.
3. Click **Add Elastic Defend**.
4. Give the integration a name (example: `Windows Elastic Defend`).
5. Scroll down and select **Complete EDR**.
6. Create a new agent policy (example: `Windows Agent Policy 1`).
7. Click **Save and continue**.

**Elastic Defend** enables endpoint detection and response on the system.

---

## Step 3: Enroll in Fleet (Fleet Server Setup)

Before adding agents, Fleet must be configured.

1. Select **Add Fleet Server**.
2. Provide:

   * **Fleet Server name:** any meaningful name
   * **URL:**

     ```
     https://<Elastic-IP>:8220
     ```

   (Port `8220` is required for agent communication.)
3. Save the Fleet Server policy.

---

## Step 4: Install Fleet Server on Kali Purple

1. Copy the **Linux Tar installation command** shown in the UI.
2. Paste and run it in the **Kali Purple terminal**.

This installs Fleet Server, which manages all enrolled agents.

---

## Step 5: Install Elastic Agent on Windows

1. Click **Add Agent** and open the **Windows** tab.
2. Copy the provided **PowerShell command**.
3. On the Windows system:

   * Paste the command into **Notepad**
   * Add the following at the end of the command:

     ```
     --insecure
     ```

   (Used when certificates are not trusted.)
4. Copy the modified command.
5. Open **PowerShell as Administrator** and paste the command.

If successful, you will see:

```
Successfully enrolled the Elastic Agent
```

---

## Step 6: Verify Agent Enrollment

* Go to **Fleet â†’ Agents** in Elastic.
* The Windows system should appear as **Healthy**.

This confirms logs and telemetry are being sent to Elastic.

---

## Step 7: Add Windows Integration

1. Go to **Integrations**.
2. Search for **Windows**.
3. Click **Add Windows**.
4. Name the integration (example: `windows-1`).
5. Select **Save and continue**.
6. Click **Save and deploy**.

The agent will automatically update and start collecting Windows logs.

---

## Outcome

* Elastic SIEM is configured
* Windows endpoint is enrolled
* Security and system logs are visible in Elastic

This setup can now be used for **SOC monitoring, detection engineering, and threat analysis**.

---
