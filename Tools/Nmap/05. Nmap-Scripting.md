# 🔍 Nmap – Scripting (NSE)

Nmap Scripting Engine (NSE) is used for:

🌐 Network discovery

🏷️ Classier version detection of a service

🚪 Backdoor detection

🛡️ Vulnerability scanning

---

## 📂 Script Categories 

* **Auth 🗝️ –** Tests or bypasses authentication systems (e.g., login checks).

* **Broadcast 📡 –** Finds devices/services by sending network-wide queries.

* **Brute force 💥 –** Tries many username/password combos to crack logins.

* **Discovery 🔎 –** Gathers information about hosts, services, or networks.

* **Exploit 💣 –** Takes advantage of known security flaws to gain access.

* **External 🌏 –** Uses data from the internet to help scanning.

* **Fuzzer 🎯 –** Sends unexpected or random data to find bugs/crashes.

* **Intrusive ⚠️ –** Runs risky scans that may crash or disturb services.

* **Malware 🦠 –** Checks if a system is infected with malicious software.

* **Safe ✅ –** Runs harmless scans without affecting target systems.

* **Version 🔢 –** Identifies software versions running on services.

* **Vuln 🚨 –** Looks for known vulnerabilities in the target system.

---

## 🧪 Practical – Attacker (Kali) | Victim (Windows & Metasploitable)

### 📌 Script Location

```
/usr/share/nmap/scripts/
```

### 🔄 Update Script Database

```
sudo nmap --script-updatedb
```

### 🔎 Find a Script

```
ls /usr/share/nmap/scripts/ | grep <script-name>
```

### ▶️ Run a Script

```
sudo nmap --script <script-name> <Target-IP>
```

---

## 💡 Common NSE Use Cases

1. **📁 **Find Directories or Files on Target -****  ``sudo nmap --script http-enum.nse -p80 <Target-IP>``

2. **📧 **Find Emails & Other Details -**** ``sudo nmap --script http-grep.nse <Target-IP>``

3. **🔓 Break FTP -** ``sudo nmap --script ftp-brute.nse <Target-IP>``

4. **🔍 Discovery / DoS Scripts -** ``nmap --script discovery <Target-IP>``

5. **🛠️ Run Scripts for a Specific Service -** ``nmap --script <script-name>* <Target-IP>``

6. **📜 Find Plugins & Versions (e.g., WordPress) -** ``ls /usr/share/nmap/scripts/ | grep wordpress``

7. **💉 SQL Injection Detection -** ``ls /usr/share/nmap/scripts/ | grep sql``

8. **🆔 Find CVEs in Target (Manual Script Installation Required) -**
   * **Step 1:** Search for vulscan on GitHub
   * **Step 2:** Clone repository

     ``sudo git clone <link>``
     
   * **Step 3:** Follow GitHub instructions to add to script database

     Run Vulscan:  ``nmap -sV --script=vulscan/vulscan.nse <Target-IP>``

9. **💻 Find PHP Version -** ``ls /usr/share/nmap/scripts/ | grep php``

10. **🚨 Run All Vulnerability Scripts -** ``nmap --script vuln <Target-IP>``

11. **🌍 IP Geo-location -** ``nmap --script ip-geolocation* <Target-IP>``

---
